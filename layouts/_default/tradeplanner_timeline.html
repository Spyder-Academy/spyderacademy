{{ define "main" }}
<section class="section pb-2 bg-dark">

    <div class="timeline-container mb-5">
        <div class="column ">
            <h4 class="gradient-profile-card gold-card text-white text-uppercase fw-bold p-3"  >Trade Planner</h4>
                <div class="post">
                    {{ partial "planner/gamma_explanation" (dict "symbol" "SPY") }}
                </div>

                <div class=" post px-4">
                    {{ partial "planner/search_ticker"}}
                </div>
    
                <div class="post">
                    {{ partial "planner/watchlist" }}
                </div>
        </div>

        <div class="column">
            <h4 class="gradient-green text-white p-3">Following on TradeSocial</h4>
            {{ partial "planner/trade_alerts" }}
        </div>


        <div class="column">
            <h4 class="gradient-red text-white p-3">Daily Reversals</h4>
            <div id="WL_Reversals"></div>
        </div>

        <div class="column">
            <h4 class="bg-primary text-white p-3">Chart Setups</h4>
            <div id="X_Charts" ></div>
        </div>

        <div class="column">
            <h4 class="bg-warning text-white p-3">Trade Ideas</h4>
            <div id="X_TradeIdeas"></div>
        </div>

        <div class="column">
            <h4 class="gradient-gold text-white p-3">OI Tracker</h4>
            <div id="WL_FlowTracker"></div>
        </div>

        <div class="column">
            <h4 class="gradient-blue text-white p-3">Options Flow</h4>
            <div id="X_OptionsFlow" ></div>
        </div>


    </div>


    

    <!-- Load Shared JS -->
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>

    <script>

        let tradePlanner = null;


        $(document).ready(function() {
            tradePlanner = new TradePlanner();

            // Gamma Generated Market Recommendation
            tradePlanner.fetchGEXByStrike("SPY", "#spyGammaChart", idx=0, historicals=false);
            tradePlanner.fetchIVData("SPY");

            // populate timeline columns
            tradePlanner.fetchScreener();
            tradePlanner.fetchAllFlow();
            tradePlanner.fetchXPosts();


        });

    </script>
</section>
{{ end }}
