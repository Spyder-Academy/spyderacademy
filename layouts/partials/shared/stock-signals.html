{{ $symbol := .symbol }}
{{ $tvSymbol := .tvSymbol }}

<div class="p-0">
    <div class="container">
        <div class="row ">
            <div class="col-12 text-danger">
                Stock Signals is currently in Beta.  Not Financial Advise!
            </div>
        </div>
        <div class="row pb-5">
            <div class="col-lg-4 col-12">
                <div class="card h-100  p-3 mb-5" style="border-radius: 15px;">
                    <div class="card-body">
                        <h4 id="marketPressureHeader" class="card-title fw-semibold text-uppercase">{{ $symbol }} MARKET PRESSURE</h4>
                        <p class="card-text" id="signalGammaOutlook"><span class="gammaOutlook"></span></p>
                        <p class="card-text text-black-61">The market price for {{ $symbol }} is currently attracted to <span class="largestGammaLevelText"></span>, and the overall sentiment is <span class="gammaOutlook"></span><br/></p>
                    </div>

                </div>
            </div>
            <div class="col-lg-4 col-12">
                <div class="card h-100  p-3 mb-5" style="border-radius: 15px;">
                    <div class="card-body">
                        <h4 id="expectedMoveHeader" class="card-title fw-semibold text-uppercase" data-toggle="tooltip" data-placement="auto">EXPECTED MOVE FOR {{ $symbol }}</h4>
                        <p class="card-text text-black-61 small" id="expectedMoveBy"></p>
                        <p class="card-text text-black-61" id="movePercentTitle">{{ $symbol }} Expected Move: <span class="movePercent"></span> (<span class="moveAmount"></span>)</p>
                        <div id="expectedMoveChop" class="alert alert-warning text-center d-none" role="alert">May be a low range day. Go Touch Grass.</div>

                        <table class="table text-center">
                            <thead class="thead-dark">
                                <tr>
                                    <th scope="col" style="background-color: #bfe1cf">Bulls Want</th>
                                    <th scope="col" style="background-color:  #a30000; color: #fff">Bears Want</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><span class="bullRange"  style="color: #29741D" ></span><span class="bullRangeHit d-none"> ðŸŽ¯</span></td>
                                    <td><span class="bearRange" style="color: #ad0000" ></span><span class="bearRangeHit d-none"> ðŸŽ¯</span></td>
                                </tr>
                            </tbody>
                        </table>

                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-12">
                <div class="card h-100  p-3 mb-5" style="border-radius: 15px;">
                    <div class="card-body">
                        <h4 id="movingAveragesHeader" class="card-title fw-semibold text-uppercase">{{ $symbol }} MOVING AVERAGES</h4>
                        <div class="card-text text-black-61" id="emaSignals">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row pb-5">
            <div class="col-lg-4 col-12">
                <div class="card h-100  p-3 mb-5" style="border-radius: 15px;">
                    <div class="card-body">
                        <h4 class="card-title fw-semibold text-uppercase">{{ $symbol }} - Technical Analysis</h4>
                        <div class="card-text text-black-61" id="theStratSignals">
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-12">
                <div class="card h-100" style="border-radius: 15px;">
                    <div class="card-body">
                        <div class="card-text text-black-61" id="theStratCombos">
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-12">
                <div class="card h-100" style="border-radius: 15px;">
                    <div class="card-body">
                        <div class="card-text text-black-61">
                            <div class="tradingview-widget-container__widget"></div>
                            <script type="application/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js" async>
                            {
                                "symbol": "{{ $tvSymbol }}",
                                "width": "100%",
                                "height": "400",
                                "interval": "D",
                                "timezone": "America/New_York",
                                "theme": "light",
                                "style": "1",
                                "locale": "en",
                                "hide_top_toolbar": true,
                                "hide_legend": false,
                                "hide_volume": true,
                                "allow_symbol_change": false,
                                "gridColor" : "rgba(255,255,255, 0)",
                                "enable_publishing": false,
                                "save_image": false,
                                "support_host": "https://www.tradingview.com"
                            }
                            </script>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row pb-5 d-none" style="width: 100%; overflow-x: auto;" id="stock_social_row"></div>

    </div>
</div>


<script>
    $(document).ready(function() {
        
        marketPressureTooltip = "<h6>MARKET PRESSURE</h6><p>It's a measure of how much buying or selling pressure there is on a stock due to options trading, becoming a magnet for where the price may move toward.</p><p>Positive net gamma means traders might buy more stock as the price goes up.</p><p>Negative net gamma means they might sell more as the price goes down.</p>"
        $('#marketPressureHeader').tooltip({
            title: marketPressureTooltip,
            html: true
        });
        
        $('#expectedMoveHeader').tooltip({
            title: "<h6>EXPECTED MOVE:</h6><p>This indicator predicts the potential price range within which a stock or asset is expected to fluctuate over a certain period, based on options pricing models.</p><p>It's a valuable tool for traders to gauge potential price movements and make informed decisions.</p><p>Keep in mind that actual market fluctuations may differ from this prediction due to various factors.</p>",
            html: true
        });

        $('#movingAveragesHeader').tooltip({
            title: "<h6>MOVING AVERAGES:</h6><p>This card shows the current price position of " + {{ $symbol }} + " relative to its key moving averages.</p><p>When the price is above an average, it's bullish; below, it's bearish.</p><p>Mixed signals, with some averages bullish and others bearish, can indicate potential consolidation or a trend change.</p><p>Use this information to gauge overall market trends and potential support/resistance levels.</p>",
            html: true
        });

        $('#expectedMoveChop').tooltip({
            title: "<h6>POSSIBLE CHOP</h6><p>An expected move < 0.5% often indicates a low range day, which is less than ideal for options traders looking for range.</p><p>Trade quick scalps or look for other names.</p>",
            html: true
        });

        var symbol = {{ $symbol }}
        var userTrades = new Trades()
        userTrades.showStockTweets(ticker=symbol);
        

    });
</script>