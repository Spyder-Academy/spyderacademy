{{ define "main" }}
<section class="section pt-1 pb-2 bg-dark">
    <div class="container-fluid " style="position: relative; overflow-x: hidden;">
        
        <div class="row p-0 m-0">
            <!-- Left Panel -->
            <!-- <div class="col-lg-2 col-sm-12 d-none d-lg-block p-0">
                Watchlist Tickers Here
            </div> -->
            <!-- Main Content Area -->
            <div class="col-lg-12 col-sm-12 p-0">
                <div class="container-fluid p-0 m-0 h-100">
                    <div class="row h-100" id="memberTrades">
                        <div class="col-12 my-0">
                            <div class="card h-100 border-0 mx-lg-3 lg-rounded">
                                <div class="row p-0 m-0 justify-content-center ">
                                    {{ partial "planner/navbar" }}
                                </div>
                                <div class="container-fluid px-3 earnings-container">
                                    <div class="row">
                                        <div class="col-12"><h1 class="gradient-text text-uppercase p-lg-3">Upcoming Earnings</h1></div>
                                    </div>
                                    <div class="row earnings_calendar ">
                                        <!-- Column for Monday -->
                                        <div class="col-md-2 col-12 p-md-3 p-0">
                                            <div class="card earnings-day lg-rounded" id="earnings-1">
                                                <div class="card-header">
                                                    <div class="day-title">MON</div>
                                                    <div class="date">-</div>
                                                </div>
                                                <div class="card-body">
                                                    <div class="earnings-section">
                                                        <div class="card lg-rounded text-white morning p-2 text-center">Before Open</div>
                                                        <div class="earnings-logos before-open py-3">
                                                            <div class="container p-0 m-0">
                                                                <div class="row"></div>
                                                             </div>
                                                        </div>
                                                    </div>
                                                    <div class="earnings-section">
                                                        <div class="card lg-rounded text-white evening p-2 text-center">After Close</div>
                                                        <div class="earnings-logos after-close">
                                                            <div class="container p-0 m-0">
                                                                <div class="row"></div>
                                                             </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Column for Tues -->
                                        <div class="col-md-2 col-12 p-md-3 p-0">
                                            <div class="card earnings-day lg-rounded" id="earnings-2">
                                                <div class="card-header">
                                                    <div class="day-title">TUE</div>
                                                    <div class="date">-</div>
                                                </div>
                                                <div class="card-body">
                                                    <div class="earnings-section">
                                                        <div class="card lg-rounded text-white morning p-2 text-center">Before Open</div>
                                                        <div class="earnings-logos before-open py-3">
                                                            <div class="container p-0 m-0">
                                                                <div class="row"></div>
                                                             </div>
                                                        </div>
                                                    </div>
                                                    <div class="earnings-section">
                                                        <div class="card lg-rounded text-white evening p-2 text-center">After Close</div>
                                                        <div class="earnings-logos after-close">
                                                            <div class="container p-0 m-0">
                                                                <div class="row"></div>
                                                             </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Column for Wed -->
                                        <div class="col-md-2 col-12 p-md-3 p-0">
                                            <div class="card earnings-day lg-rounded" id="earnings-3">
                                                <div class="card-header">
                                                    <div class="day-title">WED</div>
                                                    <div class="date">-</div>
                                                </div>
                                                <div class="card-body">
                                                    <div class="earnings-section">
                                                        <div class="card lg-rounded text-white morning p-2 text-center">Before Open</div>
                                                        <div class="earnings-logos before-open py-3">
                                                            <div class="container p-0 m-0">
                                                                <div class="row"></div>
                                                             </div>
                                                        </div>
                                                    </div>
                                                    <div class="earnings-section">
                                                        <div class="card lg-rounded text-white evening p-2 text-center">After Close</div>
                                                        <div class="earnings-logos after-close">
                                                            <div class="container p-0 m-0">
                                                                <div class="row"></div>
                                                             </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Column for Thur -->
                                        <div class="col-md-2 col-12 p-md-3 p-0">
                                            <div class="card earnings-day lg-rounded" id="earnings-4">
                                                <div class="card-header">
                                                    <div class="day-title">THU</div>
                                                    <div class="date">-</div>
                                                </div>
                                                <div class="card-body">
                                                    <div class="earnings-section">
                                                        <div class="card lg-rounded text-white morning p-2 text-center">Before Open</div>
                                                        <div class="earnings-logos before-open py-3">
                                                            <div class="container p-0 m-0">
                                                                <div class="row"></div>
                                                             </div>
                                                        </div>
                                                    </div>
                                                    <div class="earnings-section">
                                                        <div class="card lg-rounded text-white evening p-2 text-center">After Close</div>
                                                        <div class="earnings-logos after-close">
                                                            <div class="container p-0 m-0">
                                                                <div class="row"></div>
                                                             </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Column for Friday -->
                                        <div class="col-md-2 col-12 p-md-3 p-0">
                                            <div class="card earnings-day lg-rounded" id="earnings-5">
                                                <div class="card-header">
                                                    <div class="day-title">FRI</div>
                                                    <div class="date">-</div>
                                                </div>
                                                <div class="card-body">
                                                    <div class="earnings-section">
                                                        <div class="card lg-rounded text-white morning p-2 text-center">Before Open</div>
                                                        <div class="earnings-logos before-open">
                                                            <div class="container p-0 m-0">
                                                                <div class="row"></div>
                                                             </div>
                                                        </div>
                                                    </div>
                                                    <div class="earnings-section">
                                                        <div class="card lg-rounded text-white evening p-2 text-center">After Close</div>
                                                        <div class="earnings-logos after-close">
                                                            <div class="container p-0 m-0">
                                                                <div class="row"></div>
                                                             </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!-- Sliding Card -->
        <div id="earningsDetailsCard" class="rightpanel-details-card">
            <div class="details-card card border-0 shadow d-flex lg-rounded">
                <div class="card-body">
                    {{ partial "planner/stock-financials.html" }}
                </div>
            </div>
        </div>
    </div>

    


    

    <!-- Load Shared JS -->
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

    <script>

        let tradePlanner = null;

        function selectEarningsSymbol(symbol){
            event.stopPropagation();
            // const symbol = $(el).attr("symbol")
            tradePlanner.renderEarningsDetails(symbol);

            // Scroll to the top of the page
            window.scrollTo({
                top: 0,
                behavior: 'smooth' // Optional: adds a smooth scrolling effect
            });
        }

        $(document).ready(function() {
            tradePlanner = new TradePlanner();
            tradePlanner.renderEarningsCalendar().then(() => {
                $(".earnings-container").addClass("earnings-container-ready")
            })

            // Function to handle the card click and hide on outside click
            $(document).on('click', function(event) {
                var earningsDetailsCard = $('#earningsDetailsCard');
                
                // If the card is visible and the click is outside of it
                if (earningsDetailsCard.hasClass('show') && !$(event.target).closest('#earningsDetailsCard').length) {
                    earningsDetailsCard.removeClass('show');
                }
            });

            // Prevent the click inside the card from closing it
            $('#earningsDetailsCard').on('click', function(event) {
                event.stopPropagation(); // Stop the click event from bubbling up to the document
            });
        });

    </script>
</section>
{{ end }}
